apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "fe.scriptsTemplate" . }}
  labels:
    {{- include "doris.labels" . | nindent 4 }}
data:
  fe_prestop.sh: |-
    {{- .Files.Get "scripts/fe/fe_prestop.sh" | nindent 4 }}
  fe_entry_point.sh: |-
    {{- .Files.Get "scripts/fe/fe_entry_point.sh" | nindent 4 }}
  init_fe.sh: |-
    {{- .Files.Get "scripts/fe/init_fe.sh" | nindent 4 }}
  fe_role_probe.sh: |-
    {{- .Files.Get "scripts/fe/fe_role_probe.sh" | nindent 4 }}
  fe_post_start.sh: |-
    {{- .Files.Get "scripts/fe/fe_post_start.sh" | nindent 4 }}
  fe_check_status.sh: |-
    {{- .Files.Get "scripts/fe/fe_check_status.sh" | nindent 4 }}
  fe-update-dynamic-config: |-
    #!/bin/sh
    set -ex
    key="${1:?missing parameterkey}"
    value="${2:?missing parametervalue}"
    echo "key: $key, value: $value"
    sql="ADMIN SET FRONTEND CONFIG (\"$key\" = \"$value\")"
    mysql -h 127.0.0.1 -P 9030 -e "$sql"
