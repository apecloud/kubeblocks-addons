apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "redis7.scriptsTemplate" . }}
  labels:
    {{- include "redis.labels" . | nindent 4 }}
  annotations:
    {{- include "redis.annotations" . | nindent 4 }}
data:
  common.sh: |-
    #!/bin/bash
    {{- include "kblib.commons.call_func_with_retry" $ | nindent 4 }}
    {{- include "kblib.compvars.get_target_pod_fqdn_from_pod_fqdn_vars" $ | nindent 4 }}
    {{- include "kblib.pods.min_lexicographical_order_pod" $ | nindent 4 }}
    {{- include "kblib.ututils.set_xtrace_when_ut_mode_false" $ | nindent 4 }}
    {{- include "kblib.ututils.unset_xtrace_when_ut_mode_false" $ | nindent 4 }}
    {{- include "kblib.ututils.sleep_when_ut_mode_false" $ | nindent 4 }}
    {{- include "kblib.strings.contains" $ | nindent 4 }}
    {{- include "kblib.strings.is_empty" $ | nindent 4 }}
    {{- include "kblib.strings.equals" $ | nindent 4 }}
    {{- include "kblib.strings.split" $ | nindent 4 }}
    {{- include "kblib.envs.env_exist" $ | nindent 4 }}
    {{- include "kblib.envs.env_exists" $ | nindent 4 }}
  {{- with include "redis.extend.scripts" . }}
  {{- . | nindent 2 }}
  {{- end }}