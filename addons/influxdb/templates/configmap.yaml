apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "influxdb.standalone.configurationTemplate" . }}
  labels:
    {{- include "influxdb.labels" . | nindent 4 }}
data:
  config.toml: |-
    {{- .Files.Get "config/influxdb-config.tpl" | nindent 4 }}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "influxdb.meta.configurationTemplate" . }}
  labels:
    {{- include "influxdb.labels" . | nindent 4 }}
data:
  influxdb-meta.conf: |-
    {{- .Files.Get "config/influxdb-meta-config.tpl" | nindent 4 }}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "influxdb.data.configurationTemplate" . }}
  labels:
    {{- include "influxdb.labels" . | nindent 4 }}
data:
  influxdb.conf: |-
    {{- .Files.Get "config/influxdb-data-config.tpl" | nindent 4 }}

---
# scripts
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "influxdb.cmScriptsName" . }}
  labels:
    {{- include "influxdb.labels" . | nindent 4 }}
data:
  {{- range $path, $_ :=  $.Files.Glob "scripts/**" }}
  {{ $path | base }}: |-
  {{- $.Files.Get $path | nindent 4 }}
  {{- end }}
