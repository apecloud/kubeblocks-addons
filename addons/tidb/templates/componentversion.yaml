apiVersion: apps.kubeblocks.io/v1alpha1
kind: ComponentVersion
metadata:
  name: tidb-pd
  labels:
    {{- include "tidb.labels" . | nindent 4 }}
spec:
  releases:
    - name: "7.1.5"
      serviceVersion: "7.1.5"
      images:
        pd: {{ .Values.image.registry | default "docker.io" }}/{{ .Values.image.repository }}/pd:{{ default .Chart.AppVersion .Values.image.tag }}
  compatibilityRules:
    - compDefs:
        - "tidb-pd-7"
      releases:
        - "7.1.5"

---
apiVersion: apps.kubeblocks.io/v1alpha1
kind: ComponentVersion
metadata:
  name: tidb
  labels:
    {{- include "tidb.labels" . | nindent 4 }}
spec:
  releases:
    - name: "7.1.5"
      serviceVersion: "7.1.5"
      images:
        tidb: {{ .Values.image.registry | default "docker.io" }}/{{ .Values.image.repository }}/tidb:{{ default .Chart.AppVersion .Values.image.tag }}
        slowlog: {{ .Values.image.helper.image }}
  compatibilityRules:
    - compDefs:
        - "tidb-7"
      releases:
        - "7.1.5"

---
apiVersion: apps.kubeblocks.io/v1alpha1
kind: ComponentVersion
metadata:
  name: tikv
  labels:
    {{- include "tidb.labels" . | nindent 4 }}
spec:
  releases:
    - name: "7.1.5"
      serviceVersion: "7.1.5"
      images:
        tikv: {{ .Values.image.registry | default "docker.io" }}/{{ .Values.image.repository }}/tikv:{{ default .Chart.AppVersion .Values.image.tag }}
  compatibilityRules:
    - compDefs:
        - "tikv-7"
      releases:
        - "7.1.5"
