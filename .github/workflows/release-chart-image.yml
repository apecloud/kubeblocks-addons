name: Release Chart Image

on:
  workflow_dispatch:
    inputs:
      VERSION:
        description: 'The version of release chart image'
        required: true
        default: ''
      ADD_ADDONS:
        description: "The filter addons to release"
        type: string
        required: false
        default: ''
  workflow_call:
    inputs:
      VERSION:
        description: 'The version of release chart image'
        type: string
        required: false
        default: ''
      ADD_ADDONS:
        description: "The filter addons to release"
        type: string
        required: false
        default: ''

run-name: release chart image ${{ inputs.VERSION }}

jobs:
  release-charts-image:
    uses: apecloud/apecloud-cd/.github/workflows/release-image-cache2.yml@v0.1.96
    with:
      IMG: "apecloud/apecloud-addon-charts"
      VERSION: "${{ inputs.VERSION }}"
      APECD_REF: "v0.1.96"
      DOCKERFILE_PATH: "./docker/Dockerfile-charts"
      REMOVE_PREFIX: false
      ADD_ADDONS: "${{ inputs.ADD_ADDONS }}"
    secrets: inherit
