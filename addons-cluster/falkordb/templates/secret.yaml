{{- if .Values.tlsEnable }}
{{- $cn := (printf "%s-%s" (include "kblib.clusterName" .) .Release.Namespace) }}
{{- $ca := genCA "KubeBlocks" 36500 -}}
{{- $cert := genSignedCert $cn (list "127.0.0.1" "::1") (list "localhost" "*.svc.cluster.local") 36500 $ca -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "kblib.clusterName" . }}-tls
  labels: {{ include "kblib.clusterLabels" . | nindent 4 }}
  annotations:
    self-signed-cert: "true"
type: kubernetes.io/tls
data:
  tls.key: {{ $cert.Key | b64enc }}
  tls.crt: {{ $cert.Cert | b64enc }}
  ca.crt: {{ $ca.Cert | b64enc }}
{{- end }}