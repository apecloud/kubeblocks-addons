{
  "$schema": "http://json-schema.org/schema#",
  "type": "object",
  "title": "Neon Cluster Configuration",
  "description": "Configuration schema for the Neon Helm chart.",
  "properties": {
    "version": {
      "type": "string",
      "default": "1.0.0",
      "description": "Version of the Neon cluster"
    },
    "storageClassName": {
      "type": ["string", "null"],
      "default": null,
      "description": "Storage class name used by persistent volumes",
      "title": "Storage Class Name"
    },
    "compute": {
      "type": "object",
      "properties": {
        "replicas": {
          "type": "integer",
          "default": 1,
          "description": "Number of compute replicas",
          "minimum": 1
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 1,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 2,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            }
          }
        }
      }
    },
    "storagebroker": {
      "type": "object",
      "properties": {
        "replicas": {
          "type": "integer",
          "default": 1,
          "description": "Number of storage broker replicas",
          "minimum": 1
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 1,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 2,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            }
          }
        }
      }
    },
    "safekeeper": {
      "type": "object",
      "properties": {
        "replicas": {
          "type": "integer",
          "default": 3,
          "description": "Number of safekeeper replicas, forming a raft group",
          "minimum": 1
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 1,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 2,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            }
          }
        },
        "dataStorage": {
          "title": "Data Storage(Gi)",
          "description": "Data storage size for each safekeeper replica",
          "type": [
            "number",
            "string"
          ],
          "default": 20,
          "minimum": 1,
          "maximum": 10000,
          "pattern": "^[0-9]+(\\.[0-9]+)?$"
        }
      }
    },
    "pageserver": {
      "type": "object",
      "properties": {
        "replicas": {
          "type": "integer",
          "default": 1,
          "description": "Number of pageserver replicas",
          "minimum": 1
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 0.5,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": {
                  "title": "CPU",
                  "description": "CPU cores.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 1,
                  "minimum": 0.5,
                  "maximum": 64,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$",
                  "multipleOf": 0.5
                },
                "memory": {
                  "title": "Memory(Gi)",
                  "description": "Memory, the unit is Gi.",
                  "type": [
                    "number",
                    "string"
                  ],
                  "default": 2,
                  "minimum": 0.5,
                  "maximum": 1000,
                  "pattern": "^[0-9]+(\\.[0-9]+)?$"
                }
              }
            }
          }
        },
        "dataStorage": {
          "title": "Data Storage(Gi)",
          "description": "Data storage size for each pageserver replica",
          "type": [
            "number",
            "string"
          ],
          "default": 20
        }
      }
    }
  }
}