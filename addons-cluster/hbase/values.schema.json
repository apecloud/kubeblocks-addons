{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "replicas": {
      "type": "object",
      "properties": {
        "hmaster": { "type": "integer", "default": 1, "minimum": 1, "maximum": 1024 },
        "hregionserver": { "type": "integer", "default": 1, "minimum": 1, "maximum": 1024 }
      },
      "required": ["hmaster", "hregionserver"],
      "description": "Number of replicas for each component."
    },
    "resources": {
      "type": "object",
      "properties": {
        "hmaster": { "$ref": "#/definitions/resourceSchema" },
        "hregionserver": { "$ref": "#/definitions/resourceSchema" }
      },
      "required": ["hmaster", "hregionserver"],
      "description": "Resource requests and limits for each component."
    },
    "storage": {
      "type": "object",
      "properties": {
        "hbaseLog": { "type": "string", "default": "2Gi" },
        "hbaseTempData": { "type": "string", "default": "10Gi" }
      },
      "required": ["hbaseLog", "hbaseTempData"],
      "description": "Storage requirements for each component."
    },
    "serviceRefs": {
      "type": "object",
      "properties": {
        "hbaseZookeeper": {
          "type": "object",
          "properties": {
            "namespace": { "type": "string", "default": "default" },
            "clusterServiceSelector": {
              "type": "object",
              "properties": {
                "cluster": { "type": "string", "default": "zkcluster" },
                "service": {
                  "type": "object",
                  "properties": {
                    "component": { "type": "string", "default": "zookeeper" },
                    "service": { "type": "string", "default": "headless" },
                    "port": { "type": "string", "default": "client" }
                  },
                  "required": ["component", "service", "port"]
                }
              },
              "required": ["cluster", "service"]
            }
          },
          "required": ["namespace", "clusterServiceSelector"],
          "description": "Reference to ZooKeeper service."
        },
        "hadoopNamenode": {
          "type": "object",
          "properties": {
            "namespace": { "type": "string", "default": "default" },
            "clusterServiceSelector": {
              "type": "object",
              "properties": {
                "cluster": { "type": "string", "default": "hadoopcluster" },
                "service": {
                  "type": "object",
                  "properties": {
                    "component": { "type": "string", "default": "namenode" },
                    "service": { "type": "string", "default": "headless" },
                    "port": { "type": "string", "default": "client" }
                  },
                  "required": ["component", "service", "port"]
                }
              },
              "required": ["cluster", "service"]
            }
          },
          "required": ["namespace", "clusterServiceSelector"],
          "description": "Reference to Hadoop NameNode service."
        }
      },
      "required": ["hbaseZookeeper", "hadoopNamenode"],
      "description": "Service references for external dependencies."
    },
    "serviceAccount": {
      "type": "object",
      "properties": {
        "name": { "type": "string", "default": "kb-hbase-cluster" },
        "create": { "type": "boolean", "default": true }
      },
      "required": ["name", "create"],
      "description": "Configuration for the service account."
    },
    "terminationPolicy": {
      "type": "string",
      "default": "Delete",
      "description": "Policy for terminating the release."
    },
    "clusterDef": {
      "type": "string",
      "default": "hbase",
      "description": "Reference to the cluster definition."
    },
    "topology": {
      "type": "string",
      "default": "hbase-cluster",
      "description": "Cluster topology configuration."
    },
    "hadoopClusterName": {
      "type": "string",
      "default": "hadoopcluster",
      "description": "Name of the linked Hadoop cluster."
    }
  },
  "required": ["replicas", "resources", "storage", "serviceRefs", "serviceAccount", "terminationPolicy", "clusterDef", "topology", "hadoopClusterName"],
  "definitions": {
    "resourceSchema": {
      "type": "object",
      "properties": {
        "requests": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string", "default": "0.1" },
            "memory": { "type": "string", "default": "0.5Gi" }
          },
          "required": ["cpu", "memory"],
          "description": "Resource requests for the component."
        },
        "limits": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string", "default": "1" },
            "memory": { "type": "string", "default": "2Gi" }
          },
          "required": ["cpu", "memory"],
          "description": "Resource limits for the component."
        }
      },
      "required": ["requests", "limits"],
      "description": "Resource configuration for a component."
    }
  },
  "description": "Schema for HBase Helm chart values."
}
